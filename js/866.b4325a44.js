"use strict";(self["webpackChunkarbait_app"]=self["webpackChunkarbait_app"]||[]).push([[866],{850:function(e,n,t){t.d(n,{A:function(){return s}});var u=t(641),a=t(33),r={class:"button__yellow"},l=["disabled"],o=(0,u.pM)({__name:"VueYellowButton",props:{title:String,disabled:{type:Boolean,required:!1,default:!1}},setup:function(e){var n=e;return function(e,t){return(0,u.uX)(),(0,u.CE)("div",r,[(0,u.Lk)("button",{type:"button",class:"button__yellow--btn",disabled:n.disabled},(0,a.v_)(n.title),9,l)])}}});const i=o;var s=i},8655:function(e,n,t){t.r(n),t.d(n,{default:function(){return X}});var u=t(1635),a=t(641),r=t(5220),l=t(953),o=t(2110),i=t(1353),s=t(9146),c=t(4719),v=t(850),d=t(33),f={class:"timer"},p=(0,a.pM)({__name:"VueTimer",props:{initialTime:{type:Number,required:!0}},emits:["timer-complete"],setup:function(e,n){var t=n.emit,u=e,r=t,o=(0,l.KR)(u.initialTime),i=null,s=(0,a.EW)((function(){var e=o.value%60;return"00:".concat(e.toString().padStart(2,"0"))})),c=function(){i=setInterval((function(){o.value-=1,o.value<=0&&(clearInterval(i),r("timer-complete"))}),1e3)};return(0,a.sV)(c),(0,a.xo)((function(){i&&clearInterval(i)})),function(e,n){return(0,a.uX)(),(0,a.CE)("div",f,[(0,a.Lk)("p",null,(0,d.v_)(s.value),1)])}}});const m=p;var b=m,h=t(4674),_=t(7500),g=t(4335),k=t(7360),y=function(e){return(0,u.sH)(void 0,void 0,void 0,(function(){var n,t,a;return(0,u.YH)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,g.A.post("".concat(k.A,"/login"),{phone:e},{headers:{"Content-Type":"application/json"}})];case 1:return n=u.sent(),[2,n.data];case 2:return t=u.sent(),a=t,console.error("Ошибка:",a.message),_.A.error("Ошибка отправки номера: ".concat(a.message)),[2,!1];case 3:return[2]}}))}))},C=y,A=function(e,n,t,a){return(0,u.sH)(void 0,void 0,void 0,(function(){var r,l,o;return(0,u.YH)(this,(function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,g.A.post("".concat(k.A,"/verification-code"),{phone:e,code:n,token:t,offer_accepted:a},{headers:{"Content-Type":"application/json"}})];case 1:return r=u.sent(),console.log("response2",r),[2,!0];case 2:return l=u.sent(),o=l,console.error("Ошибка:",o.message),_.A.error("Ошибка ".concat(o.message)),[2,!1];case 3:return[2]}}))}))},V=A,w={class:"registration-page"},R={class:"form__user-phone"},K={key:0,class:"form__user-sms"},q={key:1,class:"form__user-get"},E={key:2,class:"form__user-send"},T={key:3,class:"form__user-offer"},H=(0,a.pM)({__name:"RegistrationPage",setup:function(e){var n=this,t=(0,r.rd)(),d=(0,r.lq)(),f=(0,h.n)(),p=(0,l.KR)(null),m=(0,l.KR)(!1),k=(0,l.KR)(""),y=(0,l.KR)(!1),A=(0,l.KR)(!1),H=(0,l.KR)(!1),L=(0,l.KR)(!1),S=(0,l.KR)(!1),X=(0,l.KR)(!1);t.push({query:(0,u.Cl)((0,u.Cl)({},d.query),{ch:String(!1)})});var F=(0,l.KR)(!1);(0,a.wB)((function(){return F.value}),(function(e){t.push({query:(0,u.Cl)((0,u.Cl)({},d.query),{ch:String(e)})})}));var I=(0,a.EW)((function(){return!F.value})),B=function(){return(0,u.sH)(n,void 0,void 0,(function(){var e,n;return(0,u.YH)(this,(function(t){switch(t.label){case 0:return L.value=!0,e=localStorage.getItem("token"),e?[4,V(p.value,k.value,e,Number(F.value))]:[3,2];case 1:n=t.sent(),n&&(_.A.success("Авторизация прошла успешно!"),f.setAuthData(e,0),g.A.defaults.headers.common["Authorization"]="Bearer ".concat(e),X.value=!0,setTimeout((function(){window.location.href="/"}),1e3)),t.label=2;case 2:return L.value=!1,[2]}}))}))},Q=function(){return(0,u.sH)(n,void 0,void 0,(function(){var e;return(0,u.YH)(this,(function(n){switch(n.label){case 0:return S.value=!0,p.value?[4,C(p.value)]:[3,2];case 1:e=n.sent(),localStorage.setItem("token",e.token),F.value=Boolean(e.offer_accepted),S.value=!1,n.label=2;case 2:return m.value=!0,H.value=!0,[2]}}))}))},U=function(e){t.push({path:e,query:(0,u.Cl)((0,u.Cl)({},d.query),{reg:"true"})})};return(0,a.sV)((function(){setTimeout((function(){F.value=!!JSON.parse(d.query.ch)}),0)})),function(e,n){var t=(0,a.gN)("loading");return(0,a.bo)(((0,a.uX)(),(0,a.CE)("div",w,[n[10]||(n[10]=(0,a.Lk)("div",{class:"registration-page__title"},[(0,a.Lk)("h2",null,"Авторизация")],-1)),(0,a.bF)(s.A,{class:"registration-page__form"},{default:(0,a.k6)((function(){return[(0,a.Lk)("div",R,[n[7]||(n[7]=(0,a.Lk)("label",null,"Номер телефона",-1)),(0,a.bF)(o.A,{modelValue:p.value,"onUpdate:modelValue":n[0]||(n[0]=function(e){return p.value=e}),placeholder:"+7(###)-###-##-##",type:"phone","is-valid":y.value,"onUpdate:isValid":n[1]||(n[1]=function(e){return y.value=e})},null,8,["modelValue","is-valid"])]),H.value?((0,a.uX)(),(0,a.CE)("div",K,[(0,a.bF)(i.A,{modelValue:k.value,"onUpdate:modelValue":n[2]||(n[2]=function(e){return k.value=e}),"is-valid":A.value,"onUpdate:isValid":n[3]||(n[3]=function(e){return A.value=e}),maxlength:4,placeholder:"####"},null,8,["modelValue","is-valid"])])):(0,a.Q3)("",!0),y.value&&!A.value?((0,a.uX)(),(0,a.CE)("div",q,[(0,a.bo)((0,a.bF)(v.A,{title:"Получить код",onClick:Q,disabled:m.value},null,8,["disabled"]),[[t,S.value]]),m.value?((0,a.uX)(),(0,a.Wv)(b,{key:0,initialTime:59,onTimerComplete:n[4]||(n[4]=function(e){return m.value=!1})})):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),A.value?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.bo)((0,a.bF)(v.A,{title:"Отправить код",onClick:B,disabled:I.value},null,8,["disabled"]),[[t,L.value]])])):(0,a.Q3)("",!0),H.value?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("p",null,[n[8]||(n[8]=(0,a.eW)(' Нажимая на кнопку "Получить код", вы соглашаетесь с условиями ')),(0,a.Lk)("span",{onClick:n[5]||(n[5]=function(e){return U("offer")})},"оферты"),n[9]||(n[9]=(0,a.eW)("! "))]),(0,a.bF)(c.A,{modelValue:F.value,"onUpdate:modelValue":n[6]||(n[6]=function(e){return F.value=e})},null,8,["modelValue"])])):(0,a.Q3)("",!0)]})),_:1})])),[[t,X.value]])}}}),L=t(6262);const S=(0,L.A)(H,[["__scopeId","data-v-1513e186"]]);var X=S}}]);
//# sourceMappingURL=866.b4325a44.js.map